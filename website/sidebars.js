// sidebars.js
const fs = require('fs');
const path = require('path');

// helper function: transform underscores → spaces + Title Case, keep acronyms uppercase
function beautify(label) {
  return label
    .replace(/_/g, ' ') // underscores → spaces
    .replace(/\b([a-z])(?=[a-z]+\b)/g, (m) => m.toUpperCase()) // capitalize words
    .replace(/\bEmth/g, 'EMTH')
    .replace(/\bEcap/g, 'ECAP')
    .replace(/\bMsc\b/g, 'M.Sc.');
}

// recursive sidebar generator that applies beautify() to folder names
function generateSidebar(dir) {
  const entries = fs.readdirSync(dir, { withFileTypes: true });

  return entries.map((entry) => {
    if (entry.isDirectory()) {
      return {
        type: 'category',
        label: beautify(entry.name),
        collapsed: true,
        items: [{ type: 'autogenerated', dirName: path.relative('docs', path.join(dir, entry.name)) }],
      };
    }
    return null;
  }).filter(Boolean);
}

module.exports = {
  tutorialSidebar: [
    {
      type: 'category',
      label: 'M.Sc. Mathematics',
      collapsed: false,
      items: [
        { type: 'autogenerated', dirName: '.' },
        ...generateSidebar('docs'), // apply transformation to all folders under docs
      ],
    },
  ],
};
